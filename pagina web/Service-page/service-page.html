<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Animate a marker</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.js"></script>
    <!-- <script src="service-page.js"></script> -->
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>

<body>
    <div id="map"></div>
    <script>
        //pk.eyJ1IjoiZnJhbjRlbmQiLCJhIjoiY2wzbHdicTZuMDN2bzNqcGpnZHAzbW80dCJ9.or8tRe6iTyOdgO2kYao3yw
        mapboxgl.accessToken = 'pk.eyJ1IjoiZnJhbjRlbmQiLCJhIjoiY2wzbHdicTZuMDN2bzNqcGpnZHAzbW80dCJ9.or8tRe6iTyOdgO2kYao3yw';
        const map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v11',
            center: [12.3, 45.5],
            zoom: 11
        });

        const marker = new mapboxgl.Marker({
            color: '#F84C4C' // color it red
        });

        function animateMarker(timestamp) {
            fetch("http://192.168.8.250:8081/position")
                .then(Response => Response.json())
                .then(data => {
                    console.log(data);
                    long = data.longitudine;
                    lati = data.latitudine;
                    marker.setLngLat([
                        long,
                        lati
                    ]);
                    marker.addTo(map);
                })
            requestAnimationFrame(animateMarker);
        }
        requestAnimationFrame(animateMarker);
    </script>

</body>

</html>